name: Golang CI
on:
  push:
    branches:
      - main
    paths:
      - "**.go"
      - "go.mod"
      - "go.sum"
      - ".github/workflows/go-ci.yml"
  pull_request:
    paths:
      - "**.go"
      - "go.mod"
      - "go.sum"
      - ".github/workflows/go-ci.yml"

# permissions:
#   contents: read
#   pull-requests: read
#   checks: write

concurrency:
  group: iamme-ci-${{ github.ref }}
  cancel-in-progress: true

jobs:
  # sast:
  #   uses: notdodo/github-actions/.github/workflows/go-security-scan.yml@29b1489bc8c392e2a8355cb29ae1cdb199aa1c1a

  build-and-test:
    uses: notdodo/github-actions/.github/workflows/go-build-and-test.yml@test

  # go-lint:
  #   name: Golang Linting
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633
  #       # v4.1.2
  #       with:
  #         fetch-depth: 0
  #     - uses: actions/setup-go@0c52d547c9bc32b1aa3301fd7a9cb496313a4491
  #       # v5.0.0
  #       with:
  #         go-version: 1.22
  #     - name: golangci-lint
  #       uses: golangci/golangci-lint-action@3cfe3a4abbb849e10058ce4af15d205b6da42804
  #       # v4.0.0
  #       with:
  #         version: latest
